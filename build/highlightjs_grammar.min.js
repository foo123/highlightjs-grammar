/**
*
*   HighlightJSGrammar
*   @version: 4.0.0
*
*   Transform a grammar specification in JSON format, into a syntax-highlight language for HighlightJS
*   https://github.com/foo123/highlightjs-grammar
*   https://github.com/foo123/editor-grammar
*
**/!function(e,t,n){"use strict";"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[t]=n.call(e)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(t)?define(t,["module"],function(t){return n.moduleUri=t.uri,n.call(e)}):t in e||(e[t]=n.call(e)||1)&&"function"==typeof define&&define.amd&&define(function(){return e[t]})}(this,"HighlightJSGrammar",function(){"use strict";function e(e){var t=0;return null===e?t=ct:!0===e||!1===e||e instanceof Boolean?t=kt:We===e?t=ut:(t=Et[tt.call(e)]||it,t=pt===t||e instanceof Number?isNaN(e)?mt:isFinite(e)?pt:ft:ht===t||e instanceof String?1===e.length?gt:ht:yt===t||e instanceof Array?yt:vt===t||e instanceof RegExp?vt:xt===t||e instanceof Date?xt:bt===t||e instanceof Function?bt:dt===t?dt:it),t}function t(e,t,n,r){var o,s,l,a,i,u,c=e.length;if(arguments.length<4&&(r=c-1),0>r&&(r+=c),arguments.length<3&&(n=0),n>r)return[];if(n===r)return[t(e[n],n,n,r)];for(l=r-n+1,a=15&l,i=1&a,u=new Array(l),i&&(u[0]=t(e[n],n,n,r)),o=i;a>o;o+=2)s=n+o,u[o]=t(e[s],s,n,r),u[o+1]=t(e[s+1],s+1,n,r);for(o=a;l>o;o+=16)s=n+o,u[o]=t(e[s],s,n,r),u[o+1]=t(e[s+1],s+1,n,r),u[o+2]=t(e[s+2],s+2,n,r),u[o+3]=t(e[s+3],s+3,n,r),u[o+4]=t(e[s+4],s+4,n,r),u[o+5]=t(e[s+5],s+5,n,r),u[o+6]=t(e[s+6],s+6,n,r),u[o+7]=t(e[s+7],s+7,n,r),u[o+8]=t(e[s+8],s+8,n,r),u[o+9]=t(e[s+9],s+9,n,r),u[o+10]=t(e[s+10],s+10,n,r),u[o+11]=t(e[s+11],s+11,n,r),u[o+12]=t(e[s+12],s+12,n,r),u[o+13]=t(e[s+13],s+13,n,r),u[o+14]=t(e[s+14],s+14,n,r),u[o+15]=t(e[s+15],s+15,n,r);return u}function n(e,t,n,r,o){var s,l,a,i,u,c=e.length,p=n;if(arguments.length<5&&(o=c-1),0>o&&(o+=c),arguments.length<4&&(r=0),r>o)return p;if(r===o)return t(p,e[r],r);for(a=o-r+1,i=15&a,u=1&i,u&&(p=t(p,e[r],r)),s=u;i>s;s+=2)l=r+s,p=t(t(p,e[l],l),e[l+1],l+1);for(s=i;a>s;s+=16)l=r+s,p=t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(p,e[l],l),e[l+1],l+1),e[l+2],l+2),e[l+3],l+3),e[l+4],l+4),e[l+5],l+5),e[l+6],l+6),e[l+7],l+7),e[l+8],l+8),e[l+9],l+9),e[l+10],l+10),e[l+11],l+11),e[l+12],l+12),e[l+13],l+13),e[l+14],l+14),e[l+15],l+15);return p}function r(e,t,n,r){if(t>n)return r;if(t===n)return e(t,r,t,n),r;var o,s,l=n-t+1,a=15&l,i=1&a;for(i&&e(t,r,t,n),o=i;a>o;o+=2)s=t+o,e(s,r,t,n),e(++s,r,t,n);for(o=a;l>o;o+=16)s=t+o,e(s,r,t,n),e(++s,r,t,n),e(++s,r,t,n),e(++s,r,t,n),e(++s,r,t,n),e(++s,r,t,n),e(++s,r,t,n),e(++s,r,t,n),e(++s,r,t,n),e(++s,r,t,n),e(++s,r,t,n),e(++s,r,t,n),e(++s,r,t,n),e(++s,r,t,n),e(++s,r,t,n),e(++s,r,t,n);return r}function o(t,n){var r,s,l,a,i=e(t),u=0;if(pt===e(n)?n>0?(u=n,n=!0):n=!1:n=!1!==n,dt===i){s={};for(l in t)t[Xe](l)&&t[Ze](l)&&(r=e(t[l]),dt===r?s[l]=n?o(t[l],u>0?u-1:n):t[l]:yt===r?s[l]=n?o(t[l],u>0?u-1:n):t[l].slice():xt===r?s[l]=new Date(t[l]):ht&r?s[l]=t[l].slice():pt&r?s[l]=0+t[l]:s[l]=t[l])}else if(yt===i)for(a=t.length,s=new Array(a),l=0;a>l;l++)r=e(t[l]),dt===r?s[l]=n?o(t[l],u>0?u-1:n):t[l]:yt===r?s[l]=n?o(t[l],u>0?u-1:n):t[l].slice():xt===r?s[l]=new Date(t[l]):ht&r?s[l]=t[l].slice():pt&r?s[l]=0+t[l]:s[l]=t[l];else s=xt===i?new Date(t):ht&i?t.slice():pt&i?0+t:t;return s}function s(){var t,n,r,l,a,i,u,c,p,f,m=arguments,k=m.length;if(1>k)return null;for(n=o(m[0]),r=1;k>r;r++)if(t=m[r])for(l in t)if(t[Xe](l)&&t[Ze](l))if(n[Xe](l)&&n[Ze](l)){if(p=e(n[l]),f=e(t[l]),dt===p&&dt===f)n[l]=s(n[l],t[l]);else if(yt===p&&yt===f){if(u=n[l],c=t[l],i=c.length,!i)continue;if(u.length)for(a=0;i>a;a++)0>u.indexOf(c[a])&&u.push(c[a]);else n[l]=c.slice()}}else n[l]=o(t[l]);return n}function l(t,n){return n||yt!==e(t)?[t]:t}function a(t,n){return t=l(t),(n||yt!==e(t[0]))&&(t=[t]),t}function i(t,n){return ht&e(n)&&ht&e(t)&&n.length&&n.length<=t.length&&n===t.substr(0,n.length)}function u(e,t,n){return n?e[t]=We:delete e[t],e}function c(e){return(e||"id_")+ ++Dt}function p(e){return(e||"uuid")+"_"+ ++Dt+"_"+(new Date).getTime()}function f(){var t,n,r,o,s,l,a=arguments,i=a.length;for(t=a[0]||{},s=1;i>s;s++)if(n=a[s],dt===e(n))for(o in n)n[Xe](o)&&n[Ze](o)&&(r=n[o],l=e(r),pt&l?t[o]=0+r:xt&l?t[o]=new Date(r):_t&l?t[o]=r.slice():t[o]=r);return t}function m(e,t){var n,r=arguments.length,o="constructor";return 0===r?(e=Object,t={}):1===r?(t=e||{},e=Object):(e=e||Object,t=t||{}),t[Xe](o)||(t[o]=function(){}),n=t[o],delete t[o],n[Qe]=f(nt(e[Qe]),t),n[Qe][o]=n,n}function k(e){return e.replace(Mt,"\\$1")}function h(e,t){return new RegExp(e,t||"")}function g(e,t,n,r){var o,s,l,a,i=e.pos,u=e.length,c="",p=!!n;if(p){for(r=!!r,s=!1,a=0;u>i&&(o=e[lt](i++),t!==o||s);)l=n===o,s=!s&&l,r?(l&&a++,(!l||2&a)&&(c+=o,a=0)):c+=o;2&a&&(c+=n)}else for(;u>i&&(o=e[lt](i++),t!==o);)c+=o;return e.pos=i,c}function $(t,n,r,o){var s,l,a,i,u,c=!0===r?0:1,p=o?"\\":"$",f=o?92:36;for(ht&e(n)&&(o&&(n=k(n)),n=[n,n,n],c=0),l=t.length,u="",s=0;l>s;)a=t[lt](s),l>s+1&&p===a?(i=t.charCodeAt(s+1),f===i?(u+=p,s+=2):i>=48&&57>=i?(u+=n[c+i-48]||"",s+=2):(u+=a,s+=1)):(u+=a,s+=1);return u}function y(t,n,r,o){if(!t||(pt|vt)&e(t))return t;var s,l=n?n.length||0:0,a="";if(ht&e(o)?a=o:o&&(a=Ft),l&&n===t.substr(0,l)){var i,u,c,s,p,f=t.substr(l),m=f[lt](0),g="";for(s=f.length;s--&&(p=f[lt](s),m!==p);)"i"===p.toLowerCase()&&(g="i");return i=f.substring(1,s),u="^("+i+")",r[u]||(c=h(u,g),r[u]=c),r[u]}return a?(u="^("+k(t)+")"+a,r[u]||(c=h(u,g),r[u]=c),r[u]):t}function d(n,r,o){var s,l="";return ht&e(r)?l=r:r&&(l=Ft),s=t(n.sort(Rt),k).join("|"),[h("^("+s+")"+l,o?"i":""),1]}function b(t,n,r,o){var s=e(n);if(pt===s)return n;if(o[t])return o[t];r=r||0;var l,a=0;return n&&n.isCharList&&(a=1,u(n,"isCharList")),l=ct===s?new D(ge,t,n,ct,r):gt===s?new D(ge,t,n,gt,r):qt&s?new D(ge,t,n,vt,r):ht&s?new D(ge,t,n,a?$t:ht,r):n,o[t]=l}function v(t,n,r,o,s,a,u,c){if(u[t])return u[t];var p,f,m,k,h,g,$,x=0,w=0,_=1,q=ht&e(o)?!0:!!o;if(p=l(n),m=p.length,1===m)$=b(t,y(p[0],r,a,o),0,u);else if(m>1){for(k=(m>>>1)+1,f=0;k>=f;f++)h=e(p[f]),g=e(p[m-1-f]),gt===h&&gt===g||(_=0),yt&h||yt&g?x=1:(vt&h||vt&g||i(p[f],r)||i(p[m-1-f],r))&&(w=1);if(_&&!q)p=p.slice().join(""),p.isCharList=1,$=b(t,p,0,u);else if(!q||x||w)if(x||w){for(f=0;m>f;f++)yt&e(p[f])?p[f]=v(t+"_"+f,p[f],r,o,s,a,u):p[f]=b(t+"_"+f,y(p[f],r,a),f,u);$=m>1?new D($e,t,p):p[0]}else{for(c&&(c.keywords=l(n).slice()),p=p.sort(Rt),f=0;m>f;f++)p[f]=b(t+"_"+f,y(p[f],r,a),f,u);$=m>1?new D($e,t,p):p[0]}else c&&(c.keywords=l(n).slice()),$=b(t,d(p,o,s),0,u)}return u[t]=$}function x(t,n,o,s,l){if(l[t])return l[t];var u=a(n),c=[],p=[];return r(function(n){var r,a,f,m;r=b(t+"_0_"+n,y(u[n][0],o,s),n,l),u[n].length>1?(f=i(u[n][1],o),m=f&&zt.test(u[n][1]),vt!==r.ptype||ht!==e(u[n][1])||!m&&f?a=b(t+"_1_"+n,y(u[n][1],o,s),n,l):m?(a=new String(u[n][1]),a.regex_pattern=o):a=u[n][1]):a=r,c.push(r),p.push(a)},0,u.length-1),l[t]=new D(ye,t,[c,p])}function w(e,t){var n=a(e.tokens.slice());r(function(e){var r=n[e][0],o=n[e].length>1?n[e][1]:n[e][0],s=n[e].length>2?n[e][2]:"";null===o?(t.line=t.line||[],t.line.push(r)):(t.block=t.block||[],t.block.push([r,o,s]))},0,n.length-1)}function _(e,n,r,o){var s=e.meta||r,l=!(!e.caseInsesitive&&!e.ci),a=t(n,function(e){return{word:e,meta:s,ci:l}});return o.autocomplete=(o.autocomplete||[]).concat(a),a}function q(t){t.Lex||(t.Lex={}),t.Syntax||(t.Syntax={});var n,r,o,l,a,i,c,p,f,m,k,h=t.Lex,g=t.Syntax,$=[h,g],y=$.length;for(k=0;y>k;){m=$[k++];for(o in m)m[Xe](o)&&(n=o.split(":"),r=n[1]&&Lt(n[1]).length?Lt(n[1]):null,n=Lt(n[0]),n.length||(n=o,r=null),n!==o&&(m[n]=m[o],u(m,o),r&&(r=r[st](),l=m[n],a=e(l),dt===a?m[n].type||(m[n].type=r):(m[n]={type:r},"error"===r?(m[n].type="action",m[n].error=l):"nop"===r?(m[n].type="action",m[n].nop=!0):"group"===r?(m[n].type="sequence",m[n].tokens=l):"action"===r&&ht===a?m[n][l]=!0:m[n].tokens=l))),h===m&&(Ot&e(m[n])&&(m[n]={type:"simple",tokens:m[n]}),l=m[n],l.type&&(p=l.type=l.type[st](),"line-block"===p?(l.type="block",l.multiline=!1,l.escape=!1):"escaped-line-block"===p?(l.type="block",l.multiline=!1,l.escape="\\"):"escaped-block"===p&&(l.type="block",l.multiline=!0,l.escape="\\"))))}m=h;for(n in m)if(m[Xe](n))for(l=m[n];l.extend;)i=l.extend,u(l,"extend"),c=h[i],c&&(Ot&e(c)&&(c=h[i]={type:"simple",tokens:c}),l=s(c,l));m=h;for(n in m)m[Xe](n)&&(l=m[n],l.type?(p=l.type=l.type[st](),"line-block"===p?(l.type="block",l.multiline=!1,l.escape=!1):"escaped-line-block"===p?(l.type="block",l.multiline=!1,l.escape="\\"):"escaped-block"===p&&(l.type="block",l.multiline=!0,l.escape="\\")):l["escaped-line-block"]?(l.type="block",l.multiline=!1,l.escape||(l.escape="\\"),l.tokens=l["escaped-line-block"],u(l,"escaped-line-block")):l["escaped-block"]?(l.type="block",l.multiline=!0,l.escape||(l.escape="\\"),l.tokens=l["escaped-block"],u(l,"escaped-block")):l["line-block"]?(l.type="block",l.multiline=!1,l.escape=!1,l.tokens=l["line-block"],u(l,"line-block")):l.comment?(l.type="comment",l.escape=!1,l.tokens=l.comment,u(l,"comment")):l.block?(l.type="block",l.tokens=l.block,u(l,"block")):l.simple?(l.type="simple",l.tokens=l.simple,u(l,"simple")):l.nop?(l.type="action",l.action=["nop",l.nop,!1],l.nop=!0):l.error?(l.type="action",l.action=["error",l.error,!!l["in-context"]],u(l,"error")):l[Xe]("context")?(l.type="action",l.action=[l.context?"context-start":"context-end",l.context,!!l["in-context"]],u(l,"context")):l.indent?(l.type="action",l.action=["indent",l.indent,!!l["in-context"]],u(l,"indent")):l.outdent?(l.type="action",l.action=["outdent",l.outdent,!!l["in-context"]],u(l,"outdent")):l.unique?(l.type="action",l.action=["unique",ht&e(l.unique)?["_DEFAULT_",l.unique]:l.unique,!!l["in-context"]],u(l,"unique")):l.push?(l.type="action",l.action=["push",l.push,!!l["in-context"]],u(l,"push")):l[Xe]("pop")?(l.type="action",l.action=["pop",l.pop,!!l["in-context"]],u(l,"pop")):l.type="simple","action"===l.type?l.ci=!(!l.caseInsesitive&&!l.ci):"block"===l.type||"comment"===l.type?(l.multiline=l[Xe]("multiline")?!!l.multiline:!0,ht&e(l.escape)||(l.escape=!1)):"simple"===l.type&&(l.meta=l.autocomplete&&ht&e(l.meta)?l.meta:null,l.ci=!(!l.caseInsesitive&&!l.ci)));m=g;for(n in m)m[Xe](n)&&(l=m[n],dt!==e(l)||l.type?l.type&&(p=l.type=l.type[st](),"group"===p&&l.match?(a=e(l.match),ht&a?(f=l.match[st](),"alternation"===f||"either"===f?(l.type="alternation",u(l,"match")):"sequence"===f||"all"===f?(l.type="sequence",u(l,"match")):"zeroorone"===f?(l.type="zeroOrOne",u(l,"match")):"zeroormore"===f?(l.type="zeroOrMore",u(l,"match")):"oneormore"===f?(l.type="oneOrMore",u(l,"match")):(l.type="sequence",u(l,"match"))):yt&a&&(l.type="repeat",l.repeat=l.match,u(l,"match"))):"either"===p?l.type="alternation":"all"===p?l.type="sequence":"lookahead"===p?l.type="positiveLookahead":"grammar"===p&&(l.type="subgrammar"),"subgrammar"!==l.type||l.tokens||(l.tokens=n)):l.ngram||l["n-gram"]?(l.type="ngram",l.tokens=l.ngram||l["n-gram"],l["n-gram"]?u(l,"n-gram"):u(l,"ngram")):l.sequence||l.all?(l.type="sequence",l.tokens=l.sequence||l.all,l.all?u(l,"all"):u(l,"sequence")):l.alternation||l.either?(l.type="alternation",l.tokens=l.alternation||l.either,l.either?u(l,"either"):u(l,"alternation")):l.zeroOrOne?(l.type="zeroOrOne",l.tokens=l.zeroOrOne,u(l,"zeroOrOne")):l.zeroOrMore?(l.type="zeroOrMore",l.tokens=l.zeroOrMore,u(l,"zeroOrMore")):l.oneOrMore?(l.type="oneOrMore",l.tokens=l.oneOrMore,u(l,"oneOrMore")):l.positiveLookahead||l.lookahead?(l.type="positiveLookahead",l.tokens=l.positiveLookahead||l.lookahead,l.lookahead?u(l,"lookahead"):u(l,"positiveLookahead")):l.negativeLookahead?(l.type="negativeLookahead",l.tokens=l.negativeLookahead,u(l,"negativeLookahead")):(l.subgrammar||l.grammar)&&(l.type="subgrammar",l.tokens=l.subgrammar||l.grammar,l.subgrammar?u(l,"subgrammar"):u(l,"grammar")));return t}function O(t,n,r){if(r=r||{},n=n||[],!t||!t.length)return n;var o,s,l,a,i,u,c;for(o=0,s=t.length;s>o;o++)if(i=t[o])if(Oe===i.type)if(i.autocompletions)for(l=0,a=i.autocompletions.length;a>l;l++)c=i.autocompletions[l],r[Xe]("w_"+c.word)||(n.push(c),r["w_"+c.word]=1);else ht===i.token.ptype&&ht&e(i.token.pattern)&&i.token.pattern.length>1&&(r[Xe]("w_"+i.token.pattern)||(n.push({word:""+i.token.pattern,meta:i.name,ci:!!i.ci}),r["w_"+i.token.pattern]=1));else if(Le===i.type)O(i.token,n,r);else if(Ae&i.type){l=0,a=i.token.length;do O([u=i.token[l++]],n,r);while(a>l&&(Ie&u.type&&1>u.min||de===u.type))}else Ie&i.type&&O([i.token[0]],n,r);return n}function E(t,n,r,o){for(var s;ht&e(s=n[t]||r[t]);)t=s;return o?t:n[t]||r[t]||t}function S(e,t){return e.length>1?r(t?function(t,n){var r=n[n.length-1],o=e[t];r===o||n.push(o)}:function(t,n){var r=n[n.length-1],o=e[t];Pt.test(o)&&Pt.test(r)&&r===o||n.push(o)},1,e.length-1,[e[0]]):e}function L(n,r,s){var l,a,i,u,c,p,f,m,$,y,d,b,v,x,w,_=!1;if(w=n.modifier?n.modifier:null,m=new String(Lt(n)),m.pos=0,1===m.length)b=""+n,r[b]||s[b]||(r[b]={type:"simple",tokens:n}),n=b;else{for(l=[],a=[],i="",v=[];m.pos<m.length;)if($=m[lt](m.pos++),Nt.test($))if(i.length&&(_?(a.length&&(d=a[a.length-1],b=d+"."+i,p=r[b]||s[b],p||(f=E(d,r,s),s[b]=ht&e(f)?new String(f):o(f),s[b].modifier=i),a[a.length-1]=b),_=!1):"0"===i?(r[Ke]||(r[Ke]={type:"simple",tokens:0}),a.push(Ke)):"^^"===i?(r[Be]||(r[Be]={type:"simple",tokens:be}),a.push(Be)):"^^1"===i?(r[Ue]||(r[Ue]={type:"simple",tokens:ve}),a.push(Ue)):"^"===i?(r[Ye]||(r[Ye]={type:"simple",tokens:we}),a.push(Ye)):"$"===i?(r[He]||(r[He]={type:"simple",tokens:xe}),a.push(He)):(r[i]||s[i]||(r[i]={type:"simple",tokens:i}),a.push(i)),i=""),"."===$)a.length&&m.pos<m.length&&!Nt.test(m[lt](m.pos))?_=!0:i+=$;else if('"'===$||"'"===$)u=g(m,$,"\\",!0),u.length?(b=""+u,r[b]||(r[b]={type:"simple",tokens:u}),a.push(b)):(r[Ve]||(r[Ve]={type:"simple",tokens:""}),a.push(Ve));else if("["===$)u=g(m,"]","\\",!0),b="["+u+"]",r[b]||(r[b]={type:"simple",tokens:h("^(["+("^"===u[lt](0)?"^"+k(u.slice(1)):k(u))+"])")}),a.push(b);else{if("]"===$){i+=$;continue}if("/"===$)u=g(m,$,"\\",!1),y="",u.length&&(m.pos<m.length&&"i"===m[lt](m.pos)&&(m.pos++,y="i"),b="/"+u+"/"+y,r[b]||(r[b]={type:"simple",tokens:h("^("+u+")",y)}),a.push(b));else if("*"===$||"+"===$||"?"===$)a.length?(d=a[a.length-1],b=""+d+$,s[b]||(s[b]={type:"*"===$?"zeroOrMore":"+"===$?"oneOrMore":"zeroOrOne",tokens:[d]}),a[a.length-1]=b):i+=$;else if("{"===$)a.length?(c=g(m,"}",!1),c=t(c.split(","),Lt),c[0].length?c[0]=parseInt(c[0],10)||0:c[0]=0,0>c[0]&&(c[0]=0),2>c.length?c.push(c[0]):c[1].length?c[1]=parseInt(c[1],10)||at:c[1]=at,0>c[1]&&(c[1]=0),d=a[a.length-1],b=""+d+["{",c[0],",",isFinite(c[1])?c[1]:"","}"].join(""),s[b]||(s[b]={type:"repeat",repeat:[c[0],c[1]],tokens:[d]}),a[a.length-1]=b):i+=$;else{if("}"===$){i+=$;continue}"&"===$||"!"===$?a.length?(d=a[a.length-1],b=""+d+$,s[b]||(s[b]={type:"!"===$?"negativeLookahead":"positiveLookahead",tokens:[d]}),a[a.length-1]=b):i+=$:"|"===$?(_=!1,a=S(a),a.length>1?(b=""+a.join(" "),s[b]||(s[b]={type:"sequence",tokens:a}),l.push(b)):a.length?l.push(a[0]):i+=$,a=[]):"("===$?(v.push([a,l,i]),a=[],l=[],i=""):")"===$&&(a=S(a),a.length>1?(b=""+a.join(" "),s[b]||(s[b]={type:"sequence",tokens:a}),l.push(b)):a.length&&l.push(a[0]),a=[],l=S(l,1),l.length>1?(b=""+l.join(" | "),s[b]||(s[b]={type:"alternation",tokens:l})):l.length&&(b=l[0]),l=[],x=v.pop(),a=x[0],l=x[1],i=x[2],d=b,b="("+d+")",s[b]||(s[b]=o(E(d,r,s))),a.push(b))}}else i+=$;i.length&&(_?(a.length&&(d=a[a.length-1],b=d+"."+i,p=r[b]||s[b],p||(f=E(d,r,s),s[b]=ht&e(f)?new String(f):o(f),s[b].modifier=i),a[a.length-1]=b),_=!1):"0"===i?(r[Ke]||(r[Ke]={type:"simple",tokens:0}),a.push(Ke)):"^^"===i?(r[Be]||(r[Be]={type:"simple",tokens:be}),a.push(Be)):"^^1"===i?(r[Ue]||(r[Ue]={type:"simple",tokens:ve}),a.push(Ue)):"^"===i?(r[Ye]||(r[Ye]={type:"simple",tokens:we}),a.push(Ye)):"$"===i?(r[He]||(r[He]={type:"simple",tokens:xe}),a.push(He)):(r[i]||s[i]||(r[i]={type:"simple",tokens:i}),a.push(i))),i="",a=S(a),a.length>1?(b=""+a.join(" "),s[b]||(s[b]={type:"sequence",tokens:a}),l.push(b)):a.length&&l.push(a[0]),a=[],l=S(l,1),l.length>1?(b=""+l.join(" | "),s[b]||(s[b]={type:"alternation",tokens:l}),n=b):l.length&&(n=l[0]),l=[]}return w&&(r[n]||s[n])&&((r[n]||s[n]).modifier=w),n}function R(o,s,i,u,c,p,f,m,k,h,g){var $,y,d,b,q,O,S,I=null,j=null,D=null;if(be===o||ve===o||we===o||xe===o)return new F(o,be===o?Be:ve===o?$T_FBNL$:we===o?Ye:He,o,j);if(!1===o||0===o)return new F(_e,Ke,0,j);if(""===o)return new F(qe,Ve,"",j);if(null===o)return new F(Oe,Je,ct,j,D);if(yt&e(o)&&(d=o,o="NGRAM_"+d.join("_"),u[o]||(u[o]={type:"ngram",tokens:d})),o=""+o,m[o])return m[o];if(q=E(o,i,u),ht&e(q)&&(q=L(q,i,u),q=i[q]||u[q]||null),!q)return null;if($=q.type?Ge[q.type[st]().replace(jt,"")]||Oe:Oe,j=q.msg||null,D=q.modifier||null,y=q.tokens,Oe&$){if(be===y||ve===y||we===y||xe===y||!1===y||0===y)return I=new F(y||_e,o,y||0,j),m[o]=I,I;if(""===y)return I=new F(qe,o,"",j),m[o]=I,I;if(null===y)return I=new F(Oe,o,ct,j,D),m[o]=I,I;if(!y)return null}if(de&$)q[Xe]("action")?"nop"===q.action[0]?q.action[0]=ae:"error"===q.action[0]?q.action[0]=ie:"context-start"===q.action[0]?q.action[0]=ce:"context-end"===q.action[0]?q.action[0]=pe:"push"===q.action[0]?q.action[0]=fe:"pop"===q.action[0]?q.action[0]=me:"unique"===q.action[0]?q.action[0]=ue:"indent"===q.action[0]?q.action[0]=ke:"outdent"===q.action[0]&&(q.action[0]=he):q[Xe]("nop")?q.action=[ae,q.nop,!!q["in-context"]]:q[Xe]("error")?q.action=[ie,q.error,!!q["in-context"]]:q[Xe]("context")?q.action=[q.context?ce:pe,q.context,!!q["in-context"]]:q[Xe]("context-start")?q.action=[ce,q["context-start"],!!q["in-context"]]:q[Xe]("context-end")?q.action=[pe,q["context-end"],!!q["in-context"]]:q[Xe]("push")?q.action=[fe,q.push,!!q["in-context"]]:q[Xe]("pop")?q.action=[me,q.pop,!!q["in-context"]]:q[Xe]("unique")?q.action=[ue,ht&e(q.unique)?["_DEFAULT_",q.unique]:q.unique,!!q["in-context"]]:q[Xe]("indent")?q.action=[ke,q.indent,!!q["in-context"]]:q[Xe]("outdent")&&(q.action=[he,q.outdent,!!q["in-context"]]),q.nop&&(q.action[0]=ae),I=new F(de,o,q.action.slice(),j,D),I.ci=!!q.caseInsensitive||q.ci,m[o]=I;else if(y=l(y),Oe&$){S=q.autocomplete?_(q,_t&e(q.autocomplete)?l(q.autocomplete):y,o,g):null;var M={};if(O="undefined"!=typeof q.combine?q.combine:!!(yt&e(q.tokens)),I=new F(Oe,o,v(o,y.slice(),s,O,!(!q.caseInsensitive&&!q.ci),p,f,M),j,D,null,S),M.keywords&&(I.keywords=M.keywords.join("|")),m[o]=I,null!=q.except){var N,z,T=l(q.except),A=T.length,C=[];for(N=0;A>N;N++)T[N]&&(z=R(T[N],s,i,u,c,p,f,m,k,h,g),z&&C.push(z));C.length&&(I.except=C)}}else Ee&$?(Se===$&&w(q,h),I=new F($,o,x(o,y.slice(),s,p,f),j),I.empty=q[Xe]("empty")?!!q.empty:!0,I.mline=q[Xe]("multiline")?!!q.multiline:!0,I.esc=q[Xe]("escape")?q.escape:!1,I.inter=!!c[o+".inside"],Se===$&&q.interleave&&k.push(P(I)),D&&(I.modifier=D),m[o]=I):Ce&$&&(Te===$?m[o]=new F(Te,o,y,j,D):Pe===$?(b=a(y),I=t(b,function(e,t){return new F(Pe,o+"_NGRAM_"+t,null,j,D)}),m[o]=I,r(function(e){I[e].token=l(n(b[e],function(e,t){return e.concat(R(t,s,i,u,c,p,f,m,k,h,g))},[]))},0,b.length-1)):(Fe===$||ze===$?I=new F($,o,null,j,D):Ie&$&&yt&e(q.repeat)?(I=new F(Ie,o,null,j,D),I.min=q.repeat[0],I.max=q.repeat[1]):je===$?(I=new F(je,o,null,j,D),I.min=0,I.max=1):De===$?(I=new F(De,o,null,j,D),I.min=0,I.max=at):Me===$?(I=new F(Me,o,null,j,D),I.min=1,I.max=at):I=Le===$?new F(Le,o,null,j,D):new F(Re,o,null,j,D),m[o]=I,I.token=l(n(y,function(e,t){return e.concat(R(t,s,i,u,c,p,f,m,k,h,g))},[]))));return m[o]}function I(t){var n={};return t.Lex=t.Lex||{},t.Syntax=t.Syntax||{},t=q(t),t.Parser&&t.Parser.length&&r(function o(s,l){var a,i,u,c=l[s];n[c]||(yt&e(c)&&(a=c,c="NGRAM_"+a.join("_"),t.Syntax[c]||(t.Syntax[c]={type:"ngram",tokens:a})),i=E(c,t.Lex,t.Syntax),ht&e(i)&&(i=L(i,t.Lex,t.Syntax),i=t.Lex[i]||t.Syntax[i]||null),i&&(n[c]=i,u=i.type?Ge[i.type[st]().replace(jt,"")]||Oe:Oe,Ce&u&&r(o,0,i.tokens.length-1,i.tokens)))},0,t.Parser.length-1,t.Parser),t}function j(t){var r,s,l,a,i,u,c,p,f,m,k,h,g,$;return t.__parsed?t:(r=t.RegExpID||null,l=t.Extra?o(t.Extra):{},a=t.Style?o(t.Style):{},i=null,u=null,c=t.Lex?o(t.Lex):{},p=t.Syntax?o(t.Syntax):{},f={},m={},k={},g={},$={},h=[],s=t.Parser?o(t.Parser):[],t=q({Style:a,Fold:i,Match:u,Lex:c,Syntax:p,$parser:null,$interleaved:null,$comments:null,$autocomplete:null,$extra:l,__parsed:0}),t.$parser=n(s,function(t,n){var o=R(n,r,c,p,a,f,m,k,h,g,$)||null;return o&&(yt&e(o)?t=t.concat(o):t.push(o)),t},[]),t.$interleaved=h&&h.length?h:null,t.$comments=g,t.$autocomplete=$&&$.autocomplete&&$.autocomplete.length?$.autocomplete:null,t.__parsed=1,t)}function D(t,n,r,o,s){var l,a,i=this;l=i.type=t,i.name=n,i.pattern=r,a=i.ptype=o||ht,i.key=s||0,$e===l?i.key=!1!==s:ye===l?i.pattern[0]=new D($e,n+"_Start",r[0],null,!1):ct===a?i.pattern=null:vt===a&&(i.pattern=vt&e(r)?[r,0]:[r[0],r[1]||0])}function M(t,n,r,o){var s,l,a,i,u,c,p,f,m,k,h,g=t,d=g.type,b=g.pattern,v=g.key;if(ye===d){if(s=g.name,a=b[0],i=b[1],c=M(a,n,r,o))return u=i[c[0]],f=e(u),m=a.pattern[c[0]].ptype,vt===m&&wt&f&&(u.regex_pattern?(p=$(u,c[1],0,1),u=new D(ge,s+"_End",y(p,u.regex_pattern,{}),vt)):(p=pt&f?c[1][u+1]:$(u,c[1]),u=new D(ge,s+"_End",p,p.length>1?ht:gt))),u}else if($e===d){for(k=0,h=b.length;h>k;k++)if(p=M(b[k],n,r,o))return v?[k,p[1]]:p}else{if(l=g.ptype,ct===l)return!1!==r&&n.end(),[v,""];if(vt===l){if(p=n.slice(n.pos).match(b[0]),p&&0===p.index)return!1!==r&&n.mov(p[b[1]||0].length),[v,b[1]>0?p[b[1]]:p]}else if($t===l){if(!0===o){p=-1;var x,w;for(h=b.length-1;h>=0;h--)x=n.indexOf(b[lt](h),n.pos),x>-1&&(-1===p||p>x)&&(p=x,w=b[lt](h));if(p>-1)return!1!==r&&(n.pos=p+1),[v,w]}else if(p=n[lt](n.pos)||null,p&&-1<b.indexOf(p))return!1!==r&&n.mov(1),[v,p]}else if(gt===l){if(!0===o){if(p=n.indexOf(b,n.pos),p>-1)return!1!==r&&(n.pos=p+1),[v,b]}else if(p=n[lt](n.pos)||null,b===p)return!1!==r&&n.mov(1),[v,p]}else if(ht===l)if(h=b.length,!0===o){if(p=n.indexOf(b,n.pos),p>-1)return!1!==r&&(n.pos=p+h),[v,b]}else if(b===n.substr(n.pos,h))return!1!==r&&n.mov(h),[v,b]}return!1}function N(e,t){this.val=e||null,t?this.prev=t:this.prev=null}function F(e,t,n,r,o,s,l,a){var i=this;i.type=e,i.name=t,i.token=n,i.modifier=o||null,i.except=s||null,i.autocompletions=l||null,i.keywords=a||null,i.pos=null,i.msg=r||null,i.$msg=null,i.status=0,i.empty=!1,i.ci=!1,i.mline=!0,i.esc=!1,i.inter=!1,i.found=0,i.min=0,i.max=1,i.i0=0,i.$id=null}function z(){var e=this;e.T=0,e.id=null,e.type=null,e.match=null,e.str="",e.pos=null,e.block=null}function P(e,t,n,r){var o=new F(e.type,e.name,e.token,e.msg,e.modifier,e.except,e.autocompletions,e.keywords);return o.empty=e.empty,o.ci=e.ci,o.mline=e.mline,o.esc=e.esc,o.inter=e.inter,o.found=e.found,o.min=e.min,o.max=e.max,o.i0=e.i0,t&&(o.status|=ne),n&&(o.modifier=n),r&&(o.$id=r),o}function T(e){var t=e.name;return e.$msg?e.$msg:e.status&ne?'Token "'+t+'"'+(e.keywords?": "+e.keywords:"")+" Expected":'Syntax Error: "'+t+'"'}function A(e,t,n,r,o,s,l){e.status&ee&&(e.err[""+t+"_"+n+"_"+r+"_"+o+"_"+(s?s.name:"ERROR")]=[t,n,r,o,l||T(s)])}function C(e,t,n){if(e.stack===t)t=e.stack=new N(n,e.stack);else{for(var r=e.stack;r&&r.prev!==t;)r=r.prev;t=new N(n,t),r&&(r.prev=t)}return t}function G(e,t,n,r){var o,s,l,a,i,u=1/0,c=null,p=1/0;if(s=t.pos,t.spc(),l=t.pos,o=e.stack,t.pos<t.length){for(i=0;o&&(a=o.val,a.$id===r.$id);){for(;!(B(a,t,e,n)||(t.pos=a.pos>t.pos?a.pos:t.pos+1,e.stack=o,t.pos>=t.length)););e.stack=o,t.pos<t.length&&u>t.pos?(u=t.pos,c=o,p=i):u===t.pos&&p>i&&(u=t.pos,c=o,p=i),t.pos=l,o=o.prev,i++}u<t.length?(t.pos=u,e.stack=c):t.end()}return l>=s&&t.pos===l}function B(e,t,n,r){if(!e)return!1;var o=e.type,s=Ce&o?J:Ee&o?H:de&o?U:Y;return s(e,t,n,r)}function U(t,n,r,o){var s,l,a,i,u,c,p,f,m,k,h,g,y,d,b,v=t,x=v.token||null,w=v.ci,_=v.name,q=!(r.status&ee);if(v.status=0,v.$msg=null,q||!x||!o||!o.pos)return!0;if(b=!!(Ee&o.T),ae===x[0]||b&&!o.block)return!0;if(s=x[0],l=x[1],g=x[2],u=v.msg,b?(d=o.block.match||o.block.str,f=o.block.pos[0][0],m=o.block.pos[0][1],k=o.block.pos[0][2],h=o.block.pos[0][3]):(d=o.match||o.str,f=o.pos[0],m=o.pos[1],k=o.pos[2],h=o.pos[3]),ie===s)return!u&&ht&e(l)&&(u=l),v.$msg=u?$(u,d,!0):'Error "'+_+'"',A(r,f,m,k,h,v,T(v)),v.status|=re,!1;if(pe===s)r.ctx=r.ctx?r.ctx.prev:null;else if(ce===s)r.ctx=new N({symb:{},queu:null},r.ctx);else if(me===s){if(g){if(!r.ctx)return!0;c=r.ctx.val.queu}else c=r.queu;if(l){if(l=$(l,d),w&&(l=l[st]()),!c||l!==c.val[0])return c?(v.$msg=u?$(u,[c.val[0],l],!0):'Tokens do not match "'+c.val[0]+'","'+l+'"',y=T(v),A(r,c.val[1],c.val[2],c.val[3],c.val[4],v,y),A(r,f,m,k,h,v,y),c=c.prev):(v.$msg=u?$(u,["",l],!0):'Token does not match "'+l+'"',y=T(v),A(r,f,m,k,h,v,y)),v.status|=re,g?r.ctx&&(r.ctx.val.queu=c):r.queu=c,!1;c=c?c.prev:null}else c=c?c.prev:null;g?r.ctx&&(r.ctx.val.queu=c):r.queu=c}else if(fe===s&&l){if(g){if(!r.ctx)return!0;c=r.ctx.val.queu}else c=r.queu;l=$(l,d),w&&(l=l[st]()),v.$msg=u?$(u,l,!0):'Token does not match "'+l+'"',c=new N([l,f,m,k,h,T(v)],c),g?r.ctx&&(r.ctx.val.queu=c):r.queu=c}else if(ue===s){if(g){if(!r.ctx)return!0;p=r.ctx.val.symb}else p=r.symb;if(a=l[1],i=l[0],a=$(a,d,!0),w&&(a=a[st]()),p[Xe](i)||(p[i]={}),p[i][Xe](a))return v.$msg=u?$(u,a,!0):'Duplicate "'+a+'"',y=T(v),A(r,p[i][a][0],p[i][a][1],p[i][a][2],p[i][a][3],v,y),A(r,f,m,k,h,v,y),v.status|=re,!1;p[i][a]=[f,m,k,h]}return!0}function Y(e,t,n,r,o){var s,l,a=e,i=a.token,u=a.modifier,c=a.type,p=a.name,f=a.except,m=n.line,k=t.pos,h=null,g=!1;if(a.status&=se,a.$msg=o?null:a.msg||null,a.pos=t.pos,f&&!o){l=V(n,t);for(var y=0,d=f.length;d>y;y++)if(s=f[y],a!==s&&Oe===s.type&&Y(s,t,n,r,1))return a.pos=s.pos,V(n,t,l),!1}return be===c?g=0===n.line:ve===c?g=n.bline+1===n.line:we===c?g=t.sol():xe===c?(t.spc(),t.eol()?g=p:(a.pos=t.pos,t.bck(k))):_e===c?(a.status=0,g=!0):qe===c?(a.status&ne&&t.spc()&&!t.eol()?(a.pos=t.pos,t.bck(k),a.status|=re):g=!0,a.status&=oe):ct===i?(t.end(),g=u||p):(h=M(i,t))&&(h=h[1],g=u||p),o?g:(!1!==g&&(r.T=c,r.id=p,r.type=g,r.str=t.sel(k,t.pos),r.match=h,r.pos=[m,k,m,t.pos]),!g&&a.status&&a.$msg&&(a.$msg=$(a.$msg,p,!0)),g)}function H(e,t,n,r){var o,s,l,a,i,u,c,p,f,m,k,h,g,y,d,b,v,x,w,_,q,O,E=e,S=E.name,L=E.type,R=E.modifier,I=E.token,j=E.mline,D=E.inter,N=D?S+".inside":S,F=E.esc,z=!!F,T="",A="",G="",U="",Y=E.$id||S,H=n.outer,J=H&&H[2],K=H&&H[1];if(E.status&=se,E.$msg=E.msg||null,E.pos=t.pos,_=n.line,q=t.pos,Se===L&&(E.status&=oe),d=E.status&ne,l=0,a=0,n.block&&n.block.name===S?(a=1,l=1,y=N,o=n.block.end,p=n.block.sp,m=n.block.ip,f=n.block.ep,T=n.block.s,A=n.block.i):!n.block&&(o=M(I,t))&&(a=1,y=S,v=t.pos,p=[_,q],m=[[_,v],[_,v]],f=[_,v],T=t.sel(q,v),A="",U="",n.block={name:S,end:o,sp:p,ip:m,ep:f,s:T,i:A,e:U}),a){if(w=n.stack,s=ct===o.ptype,b=s||E.empty,D){if(s&&l&&t.sol())return E.status&=oe,n.block=null,!1;if(!l)return v=t.pos,r.T=L,r.id=S,r.type=R||y,r.str=t.sel(q,v),r.match=null,r.pos=[_,q,_,v],C(n,w,P(E,d,0,Y)),R||y}if(v=t.pos,i=K?s&&t.eol():M(o,t),c=j,u=0,i)y=s?N:S,U=t.sel(v,t.pos);else if(x=t.pos,h=!1,K||z||$t!==o.ptype&&gt!==o.ptype&&ht!==o.ptype){for(;!t.eol();){if(K){if(B(K,t,J,r)){if(t.pos>x){s&&(i=1);break}return!0}if(s){g=t.nxt(1),G+=g;continue}}if(v=t.pos,!h&&M(o,t)){D&&t.pos>v&&v>x?(y=N,t.bck(v),u=1):(y=S,i=1),U=t.sel(v,t.pos);break}g=t.nxt(1),G+=g,h=z&&!h&&F===g,v=t.pos}s&&t.eol()&&(i=1)}else(O=M(o,t,!0,!0))?D&&t.pos>v+O[1].length?(y=N,t.mov(-O[1].length),u=1,G=t.sel(v,t.pos)):(y=S,i=1,G=t.sel(v,t.pos-O[1].length),U=O[1]):(t.end(),y=N,u=1,G=t.sel(v,t.pos));return c=j||z&&h,A+=G,m[1]=[_,v],f=[_,t.pos],i&&!b&&m[0][0]===m[1][0]&&m[0][1]===m[1][1]?(n.block=null,!1):(i||!c&&!u?n.block=null:(n.block.ip=m,n.block.ep=f,n.block.i=A,n.block.e=U,C(n,w,P(E,d,0,Y))),r.T=L,r.id=S,r.type=R||y,r.str=t.sel(q,t.pos),r.match=null,r.pos=[_,q,f[0],f[1]],E.pos=t.pos,n.block||(k=T+A+U,r.block={str:k,match:[k,A,T,U],part:[k,T,A,U],pos:[[p[0],p[1],f[0],f[1]],[p[0],p[1],m[0][0],m[0][1]],[m[0][0],m[0][1],m[1][0],m[1][1]],[m[1][0],m[1][1],f[0],f[1]]]}),R||y)}return E.status&&E.$msg&&(E.$msg=$(E.$msg,S,!0)),!1}function J(e,t,n,r){var o,s,l,a,i,u,p,f,m,k,h,g,$,y,d,b=e,v=b.type,x=(b.name,b.token),w=x.length,_=b.modifier;if(b.status&=se,b.$msg=b.msg||null,f=t.pos,m=n.stack,b.pos=t.pos,u=0,p=0,Te===v){b.status&=se;var q=new String(x[0]),O=n.stack?n.stack.val:null;return q.subgrammar=1,q.next=O?new F(Fe,O.name,[O]):null,q.required=O?O.status&ne:0,q}if(Le===v){for($=c(),b.status|=ne,g=[],d=V(n,t),h=0,k=h;w>k;k++){if(o=P(x[k],1,_,$),s=B(o,t,n,r),b.pos=o.pos,o.status&ne&&(u++,g.push(T(o))),!1!==s)return s;o.status&re&&(p++,V(n,t,d))}return u>0?b.status|=ne:b.status&=oe,w===p&&u>0?b.status|=re:b.status&=se,b.status&&!b.$msg&&g.length&&(b.$msg=g.join(" | ")),!1}if(Ae&v){y=!!(v&Re),$=b.$id||c(),y?b.status|=ne:b.status&=oe,d=V(n,t),h=0;do o=P(x[h++],y,_,$),s=B(o,t,n,r);while(w>h&&(!0===s&&Ne&o.type||!1===s&&!(o.status&ne)));if(b.pos=o.pos,!1!==s){if(!0!==s||_e!==o.type)for(k=w-1;k>=h;k--)m=C(n,m,P(x[k],1,_,$));return s.subgrammar&&w>h&&(s.next=new F(Fe,x[h].name,[x[h]]),s.required=x[h].status&ne),s}return o.status&re?(y?b.status|=re:b.status&=se,V(n,t,d)):y&&o.status&ne&&(b.status|=re),b.status&&!b.$msg&&(b.$msg=T(o)),!1}if(Ne&v)return Te&x[0].type?!0:(d=V(n,t,null,!1),s=B(P(x[0],0),t,n,r),V(n,t,d),ze===v?!1===s:!1!==s);for($=b.$id||c(),l=b.found,a=b.min,i=b.max,b.status=0,g=[],d=V(n,t),k=0;w>k;k++){if(o=P(x[k],1,_,$),s=B(o,t,n,r),b.pos=o.pos,!1!==s){if(++l,i>=l)return b.found=l,C(n,m,P(b,0,0,c())),b.found=0,s;break}o.status&ne&&(u++,g.push(T(o))),o.status&re&&V(n,t,d)}return a>l&&(b.status|=ne),(l>i||a>l&&u>0)&&(b.status|=re),b.status&&!b.$msg&&g.length&&(b.$msg=g.join(" | ")),!1}function K(e,t){var n=this;n.id=e?p("state"):"state",t instanceof K?(n.line=t.line,n.bline=t.bline,n.status=t.status,n.stack=t.stack,n.token=t.token,n.block=t.block,n.outer=t.outer?[t.outer[0],t.outer[1],new K(e,t.outer[2])]:null,n.status&ee?(n.queu=t.queu,n.symb=t.symb,n.ctx=t.ctx,n.err=t.err):(n.queu=null,n.symb=null,n.ctx=null,n.err=null),n.$eol$=t.$eol$,n.$blank$=t.$blank$):(n.line=-1,n.bline=-1,n.status=t||0,n.stack=null,n.token=null,n.block=null,n.outer=null,n.status&ee?(n.queu=[],n.symb={},n.ctx=null,n.err={}):(n.queu=null,n.symb=null,n.ctx=null,n.err=null),n.$eol$=!0,n.$blank$=!0),n.toString=function(){return n.id+"_"+n.line+"_"+n.bline+"_"+(n.block?n.block.name:"0")}}function V(e,t,n,r){return n?(e.status=n[0],e.block=n[1],e.outer=n[2],e.stack=n[3],t&&t.pos>n[4]&&t.bck(n[4]),void 0):(n=[e.status,e.block,e.outer,e.stack,t?t.pos:1/0],!1===r&&(e.status=0),n)}function W(e){e.id=null,e.line=null,e.bline=null,e.status=null,e.stack=null,e.token=null,e.block=null,e.outer=null,e.queu=null,e.symb=null,e.ctx=null,e.err=null}function Q(e,t,n){var r=new String(e);return r.start=t||0,r.pos=n||0,r.sol=function(){return 0===r.pos},r.eol=function(){return r.pos>=r.length},r.end=function(){return r.pos=r.length,r},r.mov=function(e){return r.pos=0>e?rt(0,r.pos+e):ot(r.length,r.pos+e),r},r.bck=function(e){return r.pos=rt(0,e),r},r.sft=function(){return r.start=r.pos,r},r.nxt=function(e,t){var n,o,s="";if(!0===e){for(t=t||Q.$NONSPC$;r.pos<r.length&&t.test(n=r[lt](r.pos++));)s+=n;return s.length?s:null}for(e=e||1,o=0;o++<e&&r.pos<r.length;)s+=r[lt](r.pos++);return s},r.cur=function(e){var t=r.slice(r.start,r.pos);return e&&(r.start=r.pos),t},r.sel=function(e,t){return r.slice(e,t)},r.spc=function(e,t){var n;return(n=r.slice(r.pos).match(t||Q.$SPC$))?(!1!==e&&r.mov(n[0].length),n[0]):void 0},r}function X(e,t){var n=function r(e){var t,n=null,o=null,s={lastIndex:0,exec:function(e){var t=null;return o&&(t=[o.token],t.index=0,this.lastIndex=t[0].length),t}},l={lastIndex:0,exec:function(e){var t=null;return o&&!o.ret&&(t=[o.token],t.index=0,this.lastIndex=t[0].length,o.ret=1),t}},a={_str:null,lastIndex:0,exec:function(e){var s=null,l=this;return e!==l._str?(l._str=e,l.lastIndex=l.lastIndex||0,n=r.$parser.parse(e,Z|ee|te).tokens,o=n.shift(),o.ret=0,t.parent=t,null===o.type?t.keywords=null:(t.keywords={},t.keywords[o.token]=[o.type,1]),s=[o.token],s.index=l.lastIndex,l.lastIndex+=s[0].length):n&&n.length?(l.lastIndex=l.lastIndex||0,o=n.shift(),o.ret=0,t.parent=t,null===o.type?t.keywords=null:(t.keywords={},t.keywords[o.token]=[o.type,1]),s=[o.token],s.index=l.lastIndex,l.lastIndex+=s[0].length):(l._str=null,l.lastIndex=0,n=null,o=null,t.parent=null,t.keywords=null),s}};return t={Mode:r,compiled:!0,aliases:r.aliases||null,case_insensitive:!1,relevance:0,contains:[],parent:null,keywords:null,className:null,beginRe:s,endRe:s,lexemesRe:l,terminators:a,submode:function(e,t){r.submode(e,t.Mode)}}};return n.$id=p("highlightjs_grammar_mode"),
n.$parser=new Ct.Parser(j(e)),n.submode=function(e,t){n.$parser.subparser(e,t.$parser)},n.dispose=function(){n.$parser&&n.$parser.dispose(),n.$parser=null},n.aliases=null,n}var Z=1,ee=2,te=32,ne=4,re=8,oe=~ne,se=~re,le=ne|re,ae=0,ie=4,ue=8,ce=16,pe=17,fe=32,me=33,ke=128,he=129,ge=2,$e=4,ye=8,de=4,be=8,ve=9,xe=16,we=32,_e=128,qe=256,Oe=512,Ee=1024,Se=1025,Le=2048,Re=4096,Ie=8192,je=8193,De=8194,Me=8195,Ne=16384,Fe=Ne,ze=16385,Pe=32768,Te=65536,Ae=Re|Pe,Ce=Le|Re|Ie|Ne|Pe|Te,Ge={action:de,simple:Oe,block:Ee,comment:Se,subgrammar:Te,alternation:Le,sequence:Re,repeat:Ie,zeroorone:je,zeroormore:De,oneormore:Me,positivelookahead:Fe,negativelookahead:ze,ngram:Pe},Be="$|SOF|$",Ue="$|NONBLANK|$",Ye="$|SOL|$",He="$|EOL|$",Je="$|ENDLINE|$",Ke="$|EMPTY|$",Ve="$|NONSPACE|$",We=void 0,Qe="prototype",Xe="hasOwnProperty",Ze="propertyIsEnumerable",et=Object[Qe],tt=et.toString,nt=Object.create,rt=Math.max,ot=Math.min,st="toLowerCase",lt="charAt",at=1/0,it=4,ut=8,ct=16,pt=32,ft=33,mt=34,kt=64,ht=128,gt=129,$t=130,yt=256,dt=512,bt=1024,vt=2048,xt=4096,wt=ht|pt,_t=ht|yt,qt=vt|yt,Ot=ht|yt|vt,Et={"[object Number]":pt,"[object String]":ht,"[object Array]":yt,"[object RegExp]":vt,"[object Date]":xt,"[object Function]":bt,"[object Object]":dt},St=/^\s+|\s+$/g,Lt=String[Qe].trim?function(e){return e.trim()}:function(e){return e.replace(St,"")},Rt=function(e,t){return t.length-e.length},It=/\r\n|\r|\n/g,jt=/[\-_]/g,Dt=0,Mt=/([.*+?^${}()|[\]\/\\\-])/g,Nt=/^([.!&\[\]{}()*+?\/|'"]|\s)/,Ft="(\\s|\\W|$)",zt=/(\\\\)*?\\\d/,Pt=/[*+]$/;Q.$SPC$=/^[\s\u00a0]+/,Q.$NONSPC$=/[^\s\u00a0]/,Q.$NOTEMPTY$=/\S/,Q.$SPACE$=/^\s*/;var Tt=m({constructor:function(e,t,n){var r=this;r.$grammar=e,r.$DEF=t||null,r.$ERR=n||null,r.DEF=r.$DEF,r.ERR=r.$ERR,r.$folders=[],r.$matchers=[],r.$subgrammars={}},$grammar:null,$subgrammars:null,$folders:null,$matchers:null,$n$:"name",$t$:"type",$v$:"token",$DEF:null,$ERR:null,DEF:null,ERR:null,dispose:function(){var e=this;return e.$grammar=e.$subgrammars=null,e.$folders=e.$matchers=null,e.$n$=e.$t$=e.$v$=null,e.$DEF=e.$ERR=e.DEF=e.ERR=null,e},token:function(e,t,n){var r,o,s,l,a,i,u,c,p,f,m,k,h,g,$,y,d,b=this,v=b.$grammar,x=v.Style,w=b.DEF,_=b.ERR,q={},O=b.$n$,E=b.$t$,S=b.$v$,L=v.$interleaved,R=v.$parser,I=R.length,j=L?L.length:0,D=t.outer,M=D&&D[2],N=D&&D[1];if(e.sol()&&(t.$eol$&&(t.$blank$&&(t.bline=t.line),t.$eol$=!1,t.line++),t.$blank$=t.bline+1===t.line),t.$actionerr$=!1,t.token=null,l=t.line,a=e.pos,f=!1,k=!0,m=!1,h=!1,D&&b===D[0]){if(q[O]=null,q[E]=w,q[S]=null,N){if(s=new z,B(N,e,M,s))return t.outer=null,{parser:b,state:M};for(e.nxt(1);!e.eol();){if(B(N,e,M,s)){if(e.pos>a)break;return t.outer=null,{parser:b,state:M}}e.nxt(1)}}else e.spc(),e.eol()?h=!0:e.end();return q[S]=e.cur(1),t.$eol$=e.eol(),t.$blank$=t.$blank$&&(h||t.$eol$),q}if(t.stack&&xe===t.stack.val.type&&e.sol()&&(t.stack=t.stack.prev),(!t.stack||qe!==t.stack.val.type&&null==t.block)&&e.spc()){if(t.stack&&Te===t.stack.val.type)return e.bck(a),r=t.stack.val,t.stack=t.stack.prev,f=B(r,e,t,s),g=""+f,b.$subgrammars[g]?($=b.$subgrammars[g],y=new K(1,n[g]?n[g]:t.status),M=t):($=b,y=new K,M=t),y.outer=[b,f.next,M],{parser:$,state:y,toInner:g};k=!1,h=!0}if(q[O]=null,q[E]=w,q[S]=null,k)for(s=new z,i=0;k&&(t.stack||I>i)&&!e.eol();){if(c=e.pos,p=t.stack,N){if(e.spc(),B(N,e,M,s))return e.pos>c?(q[S]=e.cur(1),t.$eol$=e.eol(),t.$blank$=t.$blank$&&!0,q):(t.outer=null,{parser:D[0],state:M,fromInner:t});e.bck(c)}if(d=!1,j&&!t.block)for(u=0;j>u;u++)if(r=L[u],f=B(r,e,t,s),!1!==f){d=!0;break}if(k&&!d){if(!t.stack&&i>=I)break;t.stack?(r=t.stack.val,t.stack=t.stack.prev):r=R[i++],f=B(r,e,t,s)}if(!1===f){if(r.status&le){t.token=r,h=G(t,e,s,r)||h,m=!0,k=!1;break}}else{if(f.subgrammar)return g=""+f,b.$subgrammars[g]?($=b.$subgrammars[g],y=new K(1,n[g]?n[g]:t.status),M=t):($=b,y=new K,M=t),y.outer=[b,f.next,M],{parser:$,state:y,toInner:g};if(t.stack&&t.stack.prev&&e.eol()&&Ee&t.stack.val.type&&t.block&&t.block.name===t.stack.val.name)for(u=t.stack.prev;u&&de===u.val.type;)o=u,u=u.prev,U(o,e,t,s),o.status&re&&(t.$actionerr$=!0);else if(t.stack&&de===t.stack.val.type)for(;t.stack&&de===t.stack.val.type;)o=t.stack.val,t.stack=t.stack.prev,U(o,e,t,s),o.status&re&&(t.$actionerr$=!0);if(!0!==f){k=!1;break}}}return k&&e.nxt(1),q[S]=e.cur(1),!1!==f?(f=x[f]||w,q[O]=r.name):m?(f=_,t.status&ee&&A(t,l,a,l,e.pos,r)):f=w,q[E]=f,t.$eol$=e.eol(),t.$blank$=t.$blank$&&(h||t.$eol$),q},get:function(e,t){for(var n=t.parser.token(e,t.state,t.inner);n&&n.parser;)n.fromInner&&t.parser!==n.parser&&(t.state.err=n.fromInner.err,t.name&&(t.inner[t.name]=n.fromInner)),n.state.err=t.state.err,n.state.line=t.state.line,n.state.bline=t.state.bline,n.state.$blank$=t.state.$blank$,n.state.$eol$=t.state.$eol$,n.state.$full_parse$=t.state.$full_parse$,t.state=n.state,t.parser=n.parser,t.name=n.toInner,n=t.parser.get(e,t);return n},tokenize:function(e,t,n){var r=[];if(e.eol())t.state.line++,t.state.$blank$&&t.state.bline++;else for(;!e.eol();)r.push(t.parser.get(e,t));return r},parse:function(e,t){var n,o,s,l,a,i,u=(e||"").split(It),c=u.length,p=null;if(t=t||Z,s=!!(t&ee),l=!!(t&Z),o={parser:this,state:new K(0,t),inner:{}},o.state.$full_parse$=!0,r(function(e){u[e]+="\n"},0,c-2),l?p=r(t&te?function(e,t){t._=t._.concat(o.parser.tokenize(Q(u[e]),o,e))}:function(e,t){t._.push(o.parser.tokenize(Q(u[e]),o,e))},0,c-1,{_:[]})._:r(function(e){var t=Q(u[e]);if(t.eol())o.state.line++,o.state.$blank$&&o.state.bline++;else for(;!t.eol();)o.parser.get(t,o)},0,c-1),n=o.state,s&&n.queu&&n.queu.length)for(;n.queu.length;)a=n.queu.shift(),A(n,a[1],a[2],a[3],a[4],null,a[5]);return i=l&&s?{tokens:p,errors:n.err}:l?p:n.err,W(n),o=n=null,i},autocompletion:function(e,t){var n,r,o=e.stack,s={},l=O([e.token],[],s);for(t=t||0;o;){if(n=o.val,r=n.type,Ie&r){if(l=O([n],l,s),0<n.min&&t<l.length)break}else if((Oe===r||Le===r||Ae&r)&&(l=O([n],l,s),t<l.length))break;o=o.prev}return l},subparser:function(e,t){var n=this;return!1===t?n.$subgrammars[Xe](e)&&delete n.$subgrammars[e]:t&&(n.$subgrammars[e]=t),n},iterator:function(){},validate:function(){},autocomplete:function(){},indent:function(){},fold:function(){},match:function(){}}),At=m(Tt,{constructor:function(e,t){var n=this;Tt.call(n,e,null,null),n.DEF=t||n.$DEF,n.ERR=n.$ERR},tokenize:function(e,n,r){var o,s=this,l=[],a=[],i=null,u=function(e){return e.type=s.$DEF,e};if(e.eol())n.state.line++,n.state.$blank$&&n.state.bline++;else for(;!e.eol();)o=n.parser.get(e,n),n.state.$actionerr$?(a.length&&(l=l.concat(t(a,u))),o.type=s.$DEF,l.push(o),a.length=0,i=null):(i!==o.name&&(a.length&&(l=l.concat(a)),a.length=0,i=o.name),a.push(o));return a.length&&(l=l.concat(a)),a.length=0,i=null,l}}),Ct={VERSION:"4.0.0",clone:o,extend:s,pre_process:I,parse:j,getMode:X,Parser:At};return Ct});